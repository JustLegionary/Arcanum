<!doctype html>
<html lang="en">

<head>
    <%- include('../views/partials/head.ejs') %>
        <!-- <script src="/js/groupListLoginPrompt.js"></script>
        <script>
            var usrId = '<%- session.userId %>'
        </script> -->
</head>

<body>
    <header>
        <%- include('../views/partials/header.ejs') %>
    </header>

    <main>


        <div class="container">
            <h1 class="display-4">
                Groups Near
                <%= session.postcode %>
            </h1>
        </div>
        <div class="container">
            <div class="row align-items-start">
                <div class="col-12">
                    <div class="card shadow">
                        <div class="card-body">
                            Local Groups
                        </div>
                    </div>
                    <% for(var i=0; i < groups.length; i++){ var numOfMembers=0; if ((groups[i].numOfMembers>= 0) &&
                        (groups[i].numOfMembers <5)){ numOfMembers=1; }else if ((groups[i].numOfMembers>= 5) &&
                            (groups[i].numOfMembers <10)){ numOfMembers=5; }else if((groups[i].numOfMembers>= 10) &&
                                (groups[i].numOfMembers <25)){ numOfMembers=10; }else if ((groups[i].numOfMembers>= 25)
                                    && (groups[i].numOfMembers <100)){ numOfMembers=25; }
                                     var
                                        groupTitle=groups[i].title.replace(/ /g,'-'); %>
                        <div class="group">
                            <div class="card shadow post">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <a href="../group/<%= groupTitle %>" class="card-title">
                                            <%= groups[i].title %>
                                        </a>
                                    </h5>
                                    <h6 class="card-subtitle mb-2 text-muted">
                                        <%if(groups[i].category){%>
                                            <%=groups[i].category%>
                                                <%}; %>
                                    </h6>
                                    <p class="card-text">
                                        <%= groups[i].description; %>
                                    </p>
                                    <div class="row">
                                        <div class="col-6 ">
                                            <p class="card-text text-muted">
                                                <%= numOfMembers %>+ Group Members
                                            </p>
                                            <p class="card-text text-muted">
                                                <%= Math.round((groups[i].dist.calculated)/1000) %>km
                                            </p>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <% } %>
                            <% if(!session.userId){%>
                                <%- include('../views/partials/groupPageLoginPrompt.ejs') %>
                                    <% } %>
                </div>
            </div>
        </div>
    </main>

    <footer>
    </footer>

</body>

</html>